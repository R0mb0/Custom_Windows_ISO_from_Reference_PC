<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Custom Windows ISO from Reference PC - Guide</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <header class="top-bar">
    <div class="logo-title">
      <span class="logo-icon">ğŸ’¿</span>
      <div>
        <h1 class="site-title">Custom Windows ISO from Reference PC</h1>
        <p class="site-subtitle">Step-by-step guide</p>
      </div>
    </div>

    <div class="top-actions">
      <!-- Manual theme toggle (cycles through auto/light/dark) -->
      <button id="theme-toggle" class="icon-button" aria-label="Toggle color theme">
        <span id="theme-toggle-icon">ğŸŒ“</span>
      </button>

      <!-- Accessibility panel toggle -->
      <button id="accessibility-toggle"
              class="icon-button"
              aria-haspopup="dialog"
              aria-expanded="false"
              aria-controls="accessibility-panel">
        â™¿
      </button>
    </div>
  </header>

  <div class="layout">
    <!-- Sidebar / Table of contents -->
    <nav class="sidebar" aria-label="Table of contents">
      <h2 class="sidebar-title">Contents</h2>
      <ol class="sidebar-list">
        <li><a href="#requirements">1. Requirements</a></li>
        <li><a href="#flash-image">2. Flash Windows 11 image</a></li>
        <li><a href="#prepare-pc">3. Prepare the target PC</a></li>
        <li><a href="#installer-guide">4. Inside Windows installer</a></li>
        <li><a href="#prepare-iso">5. Prepare the ISO content</a></li>
        <li><a href="#create-iso">6. Create the ISO image</a></li>
        <li><a href="#reference">Reference</a></li>
      </ol>
    </nav>

    <!-- Main content -->
    <main class="content" id="main-content">
      <article class="guide">
        <header class="guide-header">
          <h1>Guide ğŸ“˜</h1>
          <p class="guide-intro">
            This guide explains how to capture a custom Windows image from a reference PC,
            prepare the installer files, and create a bootable ISO image.
          </p>
        </header>

        <!-- Section 1 -->
        <section id="requirements">
          <h2>1. Requirements âœ…</h2>
          <ul>
            <li>Know how to access the BIOS settings of the target PC âš™ï¸</li>
            <li>Two USB sticks (of at least 16 GB) ğŸ’¾ğŸ’¾</li>
            <li>A sheet of paper ğŸ“</li>
            <li>A pen ğŸ–Šï¸</li>
            <li>Rufus tool:
              <ul>
                <li><code>choco install rufus</code></li>
                <li><a href="https://rufus.ie/en/" target="_blank" rel="noopener">Rufus</a></li>
              </ul>
            </li>
            <li>Windows installation image:
              <ul>
                <li><a href="https://www.microsoft.com/en-us/software-download/windows11"
                       target="_blank" rel="noopener">Windows 11 download</a></li>
              </ul>
            </li>
          </ul>
        </section>

        <!-- Section 2 -->
        <section id="flash-image">
          <h2>2. Flash the Windows 11 image to the USB stick ğŸ’¿â¡ï¸ğŸ’¾</h2>
          <ol>
            <li>Connect the first USB stick to the PC ğŸ”Œ</li>
            <li>Open Rufus ğŸš€</li>
            <li>
              Select the correct USB stick  
              <div class="image-wrapper">
                <a href="https://github.com/R0mb0/Custom_Windows_ISO_from_Reference_PC/blob/main/Imgs/1.png"
                   target="_blank" rel="noopener">
                  <img src="https://github.com/R0mb0/Custom_Windows_ISO_from_Reference_PC/blob/main/Imgs/1.png?raw=true"
                       alt="Rufus - select USB device">
                </a>
              </div>
            </li>
            <li>
              Select the Windows 11 ISO  
              <div class="image-wrapper">
                <a href="https://github.com/R0mb0/Custom_Windows_ISO_from_Reference_PC/blob/main/Imgs/2.png"
                   target="_blank" rel="noopener">
                  <img src="https://github.com/R0mb0/Custom_Windows_ISO_from_Reference_PC/blob/main/Imgs/2.png?raw=true"
                       alt="Rufus - select Windows ISO">
                </a>
              </div>
            </li>
            <li>
              Set the correct BIOS/boot partition format  
              <p>If the target PC uses UEFI, the partition table must be <strong>GPT</strong>.</p>
              <div class="image-wrapper">
                <a href="https://github.com/R0mb0/Custom_Windows_ISO_from_Reference_PC/blob/main/Imgs/3.png"
                   target="_blank" rel="noopener">
                  <img src="https://github.com/R0mb0/Custom_Windows_ISO_from_Reference_PC/blob/main/Imgs/3.png?raw=true"
                       alt="Rufus - partition scheme GPT">
                </a>
              </div>
            </li>
            <li>
              Check that the file system is <strong>NTFS</strong>  
              <div class="image-wrapper">
                <a href="https://github.com/R0mb0/Custom_Windows_ISO_from_Reference_PC/blob/main/Imgs/4.png"
                   target="_blank" rel="noopener">
                  <img src="https://github.com/R0mb0/Custom_Windows_ISO_from_Reference_PC/blob/main/Imgs/4.png?raw=true"
                       alt="Rufus - NTFS file system">
                </a>
              </div>
            </li>
            <li>
              Other options that you can set for the Windows ISO image:  
              <div class="image-wrapper">
                <a href="https://github.com/R0mb0/Custom_Windows_ISO_from_Reference_PC/blob/main/Imgs/5.png"
                   target="_blank" rel="noopener">
                  <img src="https://github.com/R0mb0/Custom_Windows_ISO_from_Reference_PC/blob/main/Imgs/5.png?raw=true"
                       alt="Rufus - advanced options">
                </a>
              </div>
            </li>
          </ol>
        </section>

        <!-- Section 3 -->
        <section id="prepare-pc">
          <h2>3. Prepare the target PC ğŸ–¥ï¸</h2>
          <ol>
            <li>Turn off the target PC (if it is on)</li>
            <li>Connect both USB sticks ğŸ’¾ğŸ’¾</li>
            <li>Turn on the PC and enter the BIOS âš™ï¸</li>
            <li>
              Set the first USB stick as the boot device  
              <br>
              At the end of the guide, it may be necessary to set
              <strong>Windows Boot Manager</strong> as the default boot option ğŸ”
            </li>
          </ol>
        </section>

        <!-- Section 4 -->
        <section id="installer-guide">
          <h2>4. Steps inside the Windows installer ğŸªŸ</h2>
          <ol>
            <li>Press <kbd>Shift</kbd> + <kbd>F10</kbd> to open <strong>Command Prompt (cmd)</strong> âŒ¨ï¸</li>
            <li>
              Type the following command and press <kbd>Enter</kbd> to open the partition tool:
              <div class="code-block">
                <pre><code>diskpart</code></pre>
                <button class="copy-button" data-copy="diskpart" aria-label="Copy command">
                  Copy
                </button>
              </div>
            </li>
            <li>
              Inside <code>diskpart</code>, list all storage volumes:
              <div class="code-block">
                <pre><code>list vol</code></pre>
                <button class="copy-button" data-copy="list vol" aria-label="Copy command">
                  Copy
                </button>
              </div>
              <p>Write down the output (for example on the sheet of paper) for the next steps ğŸ“</p>
            </li>
            <li>
              Exit <code>diskpart</code>:
              <div class="code-block">
                <pre><code>exit</code></pre>
                <button class="copy-button" data-copy="exit" aria-label="Copy command">
                  Copy
                </button>
              </div>
            </li>
            <li>
              Now type the following command (all on one line), customizing the values in angle brackets <code>&lt;...&gt;</code>:
              <div class="code-block">
                <pre><code>dism /capture-image /imagefile:&lt;drive_letter_of_second_USB&gt;:\install.wim /capturedir:&lt;drive_letter_where_Windows_is_installed&gt;:\ /scratchdir:&lt;same_drive_as_imagefile&gt;:\ /name:&lt;image_name_without_spaces&gt; /compress:maximum /checkintegrity /verify /bootable</code></pre>
                <button class="copy-button"
                        data-copy="dism /capture-image /imagefile:&lt;drive_letter_of_second_USB&gt;:\install.wim /capturedir:&lt;drive_letter_where_Windows_is_installed&gt;:\ /scratchdir:&lt;same_drive_as_imagefile&gt;:\ /name:&lt;image_name_without_spaces&gt; /compress:maximum /checkintegrity /verify /bootable"
                        aria-label="Copy command">
                  Copy
                </button>
              </div>

              <ul>
                <li><code>&lt;drive_letter_of_second_USB&gt;</code> â†’ the drive letter of the second USB stick (use the notes from <code>list vol</code>)</li>
                <li><code>&lt;drive_letter_where_Windows_is_installed&gt;</code> â†’ the drive letter where Windows is installed (for example <code>C</code>)</li>
                <li><code>&lt;same_drive_as_imagefile&gt;</code> â†’ usually the same as <code>&lt;drive_letter_of_second_USB&gt;</code></li>
                <li><code>&lt;image_name_without_spaces&gt;</code> â†’ the name you want to give to the image (no spaces)</li>
              </ul>
            </li>
            <li>
              At the end of the process, you can turn off the PC by typing:
              <div class="code-block">
                <pre><code>wpeutil shutdown</code></pre>
                <button class="copy-button" data-copy="wpeutil shutdown" aria-label="Copy command">
                  Copy
                </button>
              </div>
              and pressing <kbd>Enter</kbd> ğŸ“´
            </li>
            <li>
              The system image will be saved on the second USB stick with the name you chose! ğŸ‰ğŸ’¾
            </li>
          </ol>
        </section>

        <!-- Section 5 -->
        <section id="prepare-iso">
          <h2>5. Prepare the ISO content ğŸ“‚</h2>
          <ol>
            <li>Connect both USB sticks to the working PC ğŸ’¾ğŸ’»</li>
            <li>
              Create a working directory on the PC (for example: <code>C:\WinISO_Workdir</code>) ğŸ“
            </li>
            <li>
              Copy all the content from the Windows installer USB stick into the working directory.
            </li>
            <li>
              In the working directory, go to the <code>sources</code> folder and replace the existing
              <code>install.wim</code> file with the <code>install.wim</code> from the second USB stick
              (the one created with <code>dism</code>).
              <ul>
                <li>
                  Original file path:  
                  <code>&lt;working_directory&gt;\sources\install.wim</code>
                </li>
                <li>
                  New file path (from second USB):  
                  <code>&lt;second_USB_drive_letter&gt;:\install.wim</code>
                </li>
              </ul>
            </li>
          </ol>
        </section>

        <!-- Section 6 -->
        <section id="create-iso">
          <h2>6. Create the ISO image ğŸ’¿</h2>
          <ol>
            <li>
              Install the <strong>Windows ADK</strong> (Assessment and Deployment Kit):
              <ul>
                <li>
                  <strong>Using Chocolatey</strong>:
                  <div class="code-block">
                    <pre><code>choco install windows-adk</code></pre>
                    <button class="copy-button"
                            data-copy="choco install windows-adk"
                            aria-label="Copy command">
                      Copy
                    </button>
                  </div>
                </li>
                <li>
                  Or by using the official installer:  
                  <a href="https://learn.microsoft.com/en-us/windows-hardware/get-started/adk-install"
                     target="_blank" rel="noopener">
                    Windows ADK installer
                  </a>
                </li>
              </ul>
            </li>
            <li>
              Open <strong>Deployment and Imaging Tools Environment</strong> as Administrator.
            </li>
            <li>
              Once you are inside the working directory, run the following command (all on one line),
              replacing the values in <code>&lt;...&gt;</code> with your paths:
              <div class="code-block">
                <pre><code>oscdimg.exe -m -o -u2 -udfver102 -bootdata:2#p0,e,b&lt;Source Path&gt;\boot\etfsboot.com#pEF,e,b&lt;Source Path&gt;\efi\microsoft\boot\efisys.bin &lt;Source Path&gt; &lt;Saving path and name of file&gt;</code></pre>
                <button class="copy-button"
                        data-copy="oscdimg.exe -m -o -u2 -udfver102 -bootdata:2#p0,e,b&lt;Source Path&gt;\boot\etfsboot.com#pEF,e,b&lt;Source Path&gt;\efi\microsoft\boot\efisys.bin &lt;Source Path&gt; &lt;Saving path and name of file&gt;"
                        aria-label="Copy command">
                  Copy
                </button>
              </div>

              <p>Where:</p>
              <ul>
                <li>
                  <code>&lt;Source Path&gt;</code> â†’ the full path of the working directory  
                  (for example <code>C:\WinISO_Workdir</code>)
                </li>
                <li>
                  <code>&lt;Saving path and name of file&gt;</code> â†’ the full path and file name of the ISO
                  you want to create (for example <code>D:\ISOs\Custom_Windows11.iso</code>)
                </li>
              </ul>
            </li>
            <li>
              When the command finishes successfully, your custom ISO image will be available at:  
              <code>&lt;Saving path and name of file&gt;</code> ğŸ‰ğŸ’¾
            </li>
          </ol>
        </section>

        <!-- Reference -->
        <section id="reference">
          <h2>Reference ğŸ”—</h2>
          <ul>
            <li>
              <a href="https://www.tenforums.com/tutorials/72031-create-windows-10-iso-image-existing-installation.html"
                 target="_blank" rel="noopener">
                Create Windows 10 ISO image from existing installation (TenForums)
              </a>
            </li>
          </ul>
        </section>
      </article>
    </main>
  </div>

  <!-- Accessibility panel (popup-style) -->
  <div id="accessibility-panel"
       class="accessibility-panel"
       role="dialog"
       aria-modal="false"
       aria-labelledby="accessibility-title"
       hidden>
    <div class="accessibility-panel-inner">
      <header class="accessibility-header">
        <h2 id="accessibility-title">Accessibility options</h2>
        <button id="accessibility-close" class="icon-button" aria-label="Close accessibility panel">
          âœ•
        </button>
      </header>

      <section class="accessibility-section">
        <h3>Theme</h3>
        <div class="button-group" role="radiogroup" aria-label="Theme selection">
          <button class="btn radio-btn" data-theme="auto">Auto</button>
          <button class="btn radio-btn" data-theme="light">Light</button>
          <button class="btn radio-btn" data-theme="dark">Dark</button>
        </div>
        <p class="accessibility-hint">
          In <strong>Auto</strong> mode the site follows your system/browser color scheme.
        </p>
      </section>

      <section class="accessibility-section">
        <h3>Text size</h3>
        <div class="button-group">
          <button id="font-decrease" class="btn">Aâˆ’</button>
          <button id="font-reset" class="btn">A</button>
          <button id="font-increase" class="btn">A+</button>
        </div>
        <p class="accessibility-hint">
          Adjust the font size to improve readability. Your choice is saved for future visits.
        </p>
      </section>
    </div>
  </div>

  <!-- Copy notification -->
  <div id="copy-toast" class="copy-toast" role="status" aria-live="polite" hidden>
    Command copied to clipboard
  </div>

  <script src="script.js"></script>
</body>
</html>
